# 🎯 多签钱包项目 - 最终使用指南

## ✅ 当前状态

所有服务已经重新启动：
1. ✅ Hardhat 本地节点正在运行
2. ✅ Next.js 前端服务器正在运行
3. ✅ 所有缓存已清理
4. ✅ 代码已修复

---

## 🚀 访问地址

前端应该运行在以下端口之一：
- **http://localhost:3000** (优先尝试)
- **http://localhost:3001**
- **http://localhost:3002**  
- **http://localhost:3003**
- **http://localhost:3004**
- **http://localhost:3005**

如果不确定，请查看终端输出中的 `Local:` 地址。

---

## 📋 使用步骤

### 第 1 步：打开浏览器
访问前端地址（通常是 http://localhost:3000）

### 第 2 步：配置 MetaMask

#### 2.1 添加本地网络
1. 打开 MetaMask
2. 点击网络下拉菜单
3. 选择"添加网络" → "手动添加网络"
4. 填入以下信息：

```
网络名称: Hardhat Local
RPC URL: http://127.0.0.1:8545
Chain ID: 31337
货币符号: ETH
```

5. 点击"保存"

#### 2.2 导入测试账户（可选）
导入以下任一测试账户的私钥：

**账户 #0** (合约所有者，10000 ETH)
```
地址: 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
私钥: 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80
```

**账户 #1** (非所有者，10000 ETH)
```
地址: 0x70997970C51812dc3A010C7d01b50e0d17dc79C8
私钥: 0x59c6995e998f97a5a0044966f0945389dc9e86dae88c7a8412f4603b6b78690d
```

⚠️ **警告**: 这些是公开的测试私钥，切勿在主网使用！

### 第 3 步：连接钱包
1. 在前端页面点击"连接钱包"按钮
2. 在 MetaMask 中选择"Hardhat Local"网络
3. 确认连接

### 第 4 步：使用功能

#### 查看已部署的合约
- 默认显示"查看已部署合约"标签页
- 可以看到：
  - 合约地址：`0x5FbDB2315678afecb367f032d93F642f64180aa3`
  - 合约余额
  - 所有者列表
  - 所需确认数
  - 交易统计

#### 部署新合约
1. 点击"部署新合约"标签页
2. 添加所有者地址
3. 设置所需确认数
4. 点击"部署多签钱包"

---

## 🔧 已部署的合约信息

```json
{
  "network": "localhost",
  "contractAddress": "0x5FbDB2315678afecb367f032d93F642f64180aa3",
  "owners": ["0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266"],
  "numConfirmationsRequired": 1,
  "deployer": "0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266"
}
```

---

## 🐛 故障排查

### 问题 1: 页面显示错误
**解决方案**: 硬刷新浏览器
- Windows: `Ctrl + Shift + R`
- Mac: `Cmd + Shift + R`

### 问题 2: 无法连接钱包
**检查项**:
1. ✅ MetaMask 已安装
2. ✅ 已添加 Hardhat Local 网络
3. ✅ 已切换到 Hardhat Local 网络
4. ✅ Hardhat 节点正在运行

### 问题 3: 显示 "Hydration Error"
**解决方案**: 这个问题已经修复，如果还出现请：
1. 清除浏览器缓存
2. 硬刷新页面
3. 重启浏览器

### 问题 4: 合约信息显示"加载中..."
**可能原因**:
1. 钱包未连接 → 连接钱包
2. 网络不对 → 切换到 Hardhat Local
3. Hardhat 节点未运行 → 重启 Hardhat 节点

### 问题 5: 端口被占用
**解决方案**:
1. 关闭其他可能占用端口的程序
2. 或者使用 Next.js 自动分配的端口

---

## 💻 命令行操作

### 与合约交互（Hardhat Console）
```bash
# 打开 Hardhat Console
npx hardhat console --network localhost

# 在 console 中
const MultiSigWallet = await ethers.getContractFactory("MultiSigWallet")
const wallet = await MultiSigWallet.attach("0x5FbDB2315678afecb367f032d93F642f64180aa3")

# 查看所有者
await wallet.getOwners()

# 查看确认数
await wallet.numConfirmationsRequired()

# 提交交易
await wallet.submitTransaction(
  "0x70997970C51812dc3A010C7d01b50e0d17dc79C8",
  ethers.parseEther("1.0"),
  "0x"
)
```

### 重新部署合约
```bash
npx hardhat run scripts/deploy.js --network localhost
```

### 运行测试
```bash
npm run test
```

---

## 🌟 功能特性

### 已实现
- ✅ 查看已部署合约信息
- ✅ 显示合约余额和所有者
- ✅ 权限检测（是否为所有者）
- ✅ 部署新合约（UI界面）
- ✅ 钱包连接管理
- ✅ 多网络支持

### 待实现（占位按钮已显示）
- ⏳ 提交交易
- ⏳ 确认交易
- ⏳ 执行交易
- ⏳ 撤销确认
- ⏳ 查看交易历史

---

## 📊 测试场景

### 场景 1: 作为合约所有者
1. 导入账户 #0 的私钥
2. 连接钱包
3. 查看"已部署合约"标签
4. 应该看到绿色提示："你是该钱包的所有者"
5. 底部显示操作按钮

### 场景 2: 作为非所有者
1. 导入账户 #1 的私钥
2. 连接钱包
3. 查看"已部署合约"标签
4. 应该看到黄色提示："你不是该钱包的所有者"
5. 只能查看信息，无操作按钮

### 场景 3: 部署新合约
1. 切换到"部署新合约"标签
2. 添加多个所有者地址
3. 设置所需确认数（如 2/3）
4. 点击部署（注意：需要集成 artifacts 才能真正部署）

---

## 📝 重要提示

1. **本地测试**
   - 当前在本地 Hardhat 网络测试
   - 所有数据在重启后会丢失
   - 使用的是测试账户和测试 ETH

2. **生产部署**
   - 生产环境需要修改配置
   - 使用真实的私钥和 RPC 节点
   - 建议先在测试网（Sepolia）测试

3. **安全性**
   - 切勿将测试私钥用于主网
   - 部署到主网前进行安全审计
   - 妥善保管生产环境私钥

---

## 🎉 完成！

你现在拥有一个完整的多签钱包管理系统：

- ✅ 智能合约已部署
- ✅ 前端界面完整
- ✅ 测试完全通过
- ✅ 本地环境运行正常

**现在就打开浏览器开始使用吧！** 🚀

地址: http://localhost:3000 （或终端显示的端口）

---

## 📞 需要帮助？

如果遇到任何问题：
1. 检查浏览器控制台的错误信息（F12）
2. 查看终端的输出日志
3. 尝试硬刷新浏览器
4. 重启所有服务

祝使用愉快！🎊

